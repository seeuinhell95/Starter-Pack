#pragma semicolon 1

#include <sourcemod>
#include <sdktools>
#include <sdkhooks>

public Plugin myinfo =
{
	name = "[CSGO] Server Lag Exploit Fix",
	author = "BackWards | Edited: somebody.",
	description = "Server Lag Exploit Fix",
	version = "1.0",
	url = "http://sourcemod.net"
}

public OnPluginStart()
{
	new Address:addy = GameConfGetAddress(LoadGameConfigFile("LagExploitFix"), "InvalidReliableState");

	if (GetEngineVersion() == Engine_CSGO)
	{
		new OS = LoadFromAddress(addy + Address:1, NumberType_Int8);
		switch(OS)
		{
			case 0x89:
			{
				for(int i = 0;i<36;i++)
					StoreToAddress((addy + Address:0x9E8 + view_as<Address>(i)), 0x90, NumberType_Int8);
			}
			case 0x8B:
			{
				for(int i = 0;i<28;i++)
					StoreToAddress((addy + Address:0x85F + view_as<Address>(i)), 0x90, NumberType_Int8);
			}
			default:
			{
				SetFailState("InvalidReliableState Signature Incorrect. (0x%.2x)", OS);
			}
		}
	}
}